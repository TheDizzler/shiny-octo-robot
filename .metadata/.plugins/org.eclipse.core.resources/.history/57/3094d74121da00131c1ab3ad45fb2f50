package vdindustries.planview;

import java.util.ArrayList;

import vdindustries.content.Deficiency;
import vdindustries.content.DeficiencyParser;
import vdindustries.masterflow.R;
import android.graphics.Canvas;
import android.os.Bundle;
import android.support.v7.app.ActionBarActivity;
import android.view.ViewGroup.LayoutParams;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.RelativeLayout;


public class NewPlans extends ActionBarActivity {
	
	
	private NewPlans				context;
	private ImageView				plan;
	
	private ImageButton				test;
	private ImageButton				test2;
	Canvas							canvas;
	private RelativeLayout			layout;
	LayoutParams					params;
	LayoutParams					buttonLayout;
	private LayoutParams			planLayout;
	private List<Deficiency>	defs;
	private ArrayList<ImageButton>	defBtns;
	
	@Override protected void onCreate(Bundle savedInstanceState) {
	
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_newplanview);
		
		context = this;
		
		layout = (RelativeLayout) findViewById(R.id.rl);
		buttonLayout = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
		planLayout = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
		
//		plan = (ImageView) findViewById(R.id.new_plan);
//		test = (ImageButton) findViewById(R.id.flag_button_blue);
		
		showRoom("201");
		
		
//		test = new ImageButton(this);
//		
//		test.setImageDrawable(getResources().getDrawable(R.drawable.flag_blue));
//		test.setLayoutParams(buttonLayout);
//		test.setId(13);
//		test.setX(150);
//		test.setY(150);
//		layout.addView(test);
		
	}
	
	
	private void showDeficiencies(String roomNo) {
	
		defs = new ArrayList<Deficiency>();
		defBtns = new ArrayList<ImageButton>();
		
		defs = DeficiencyParser.getDefsByRoom(roomNo);
		
		for (int i = 0; i < defs.size(); ++i) {
			
			Deficiency def = defs.get(i);
			ImageButton btn = new ImageButton(this);
			
			btn.setImageDrawable(getResources().getDrawable(R.drawable.flag_blue));
			btn.setLayoutParams(buttonLayout);
			btn.setId(13);
			btn.setX(150);
			btn.setY(150);
			layout.addView(btn);
			defBtns.add(btn);
		}
		
	}
	
	
	private void showRoom(String roomNo) {
	
		plan = new TouchImageView(this);
		plan.setLayoutParams(planLayout);
		DeficiencyParser.loadRoomPlan(plan, roomNo);
		layout.addView(plan);
		
		showDeficiencies(roomNo);
	}
	
}
