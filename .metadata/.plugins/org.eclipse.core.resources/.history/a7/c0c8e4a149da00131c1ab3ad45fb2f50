package vdindustries.checklists;


import org.w3c.dom.Element;

import vdindustries.Qdap.R;
import vdindustries.content.Deficiency;
import vdindustries.content.DeficiencyParser;
import vdindustries.planview.TouchImageView;
import android.os.Bundle;
import android.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.ImageView;
import android.widget.RelativeLayout;

/** Fragment lifecycle:
 * onAttach()
 * onCreate()
 * onCreateView()
 * onActivityCreated() - Activity and fragment instance
 * 		have been created as well as thier view hierarchy. At this
 * 		point, view can be accessed with the findViewById() method.
 * onResume()
 * onPause()
 * onStop()
 * @author T-Dawg */
public class PlanFragment extends Fragment {
	
	Room					current;
	RelativeLayout			layout;
//	private LayoutParams	planLayoutParams;
	
	public View onCreateView(LayoutInflater inflater, ViewGroup container,
								Bundle savedInstanceState) {
	
		
		return inflater.inflate(R.layout.fragment_checklists_plan, container, false);
	}
	
	
	@Override public void onActivityCreated(Bundle savedInstanceState) {
	
		super.onActivityCreated(savedInstanceState);
		
		ImageView currentImage = (ImageView) getActivity().findViewById(R.id.plan_image);
		
		layout = (RelativeLayout) getActivity().findViewById(R.id.plan_fragment);
//		LayoutParams planLayoutParams = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
//		currentImage.setLayoutParams(planLayoutParams);
		
		// Load the first floor of building as default. This is neccessary
		// or else floorplans will not load before a roomplan is loaded.
		loadFloorPlan(((Element) DeficiencyParser.listFloorNodes.item(0)).getAttribute(Deficiency.FLOORID));
	}
	
	
	public void loadFloorPlan(String floorID) {
	
		ImageView currentImage = (ImageView) getActivity().findViewById(R.id.plan_image);
		DeficiencyParser.loadFloorPlan(currentImage, floorID);
		
		((TouchImageView) currentImage).resetZoom();
	}
	
	
	public void loadRoomPlan(String roomNo) {
	
		
		ImageView currentImage = (ImageView) getActivity().findViewById(R.id.plan_image);
		layout.isActivated();
		current = new Room(getActivity(), roomNo, currentImage, layout);
		((TouchImageView) currentImage).resetZoom();
	}
	
	
	
}
